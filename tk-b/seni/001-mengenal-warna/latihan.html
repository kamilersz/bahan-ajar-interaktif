<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latihan Warna - TK-B Seni</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Comic Neue', cursive;
        }
        .title-font {
            font-family: 'Fredoka One', cursive;
        }
        .wiggle {
            animation: wiggle 1s ease-in-out infinite;
        }
        @keyframes wiggle {
            0%, 100% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
        }
        .bounce {
            animation: bounce 0.6s ease;
        }
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .shake {
            animation: shake 0.5s ease;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        .confetti {
            position: fixed;
            width: 15px;
            height: 15px;
            background-color: #f00;
            animation: confetti-fall 3s ease-out forwards;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        .pulse-glow {
            animation: pulse-glow 1.5s ease-in-out infinite;
        }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); }
            50% { box-shadow: 0 0 25px rgba(255, 255, 255, 0.9); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-yellow-100 via-pink-100 to-blue-100 min-h-screen"
      x-data="colorGame()">
    <!-- Header -->
    <header class="bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 text-white py-6 shadow-lg">
        <div class="container mx-auto px-4 text-center">
            <h1 class="title-font text-4xl md:text-5xl mb-2 wiggle inline-block">ğŸ® Latihan Warna ğŸ®</h1>
            <p class="text-xl">Ayo Bermain dengan Warna!</p>
            <div class="mt-4 bg-white/20 rounded-full px-6 py-2 inline-block">
                <span class="text-2xl">â­ Skor: <span x-text="score"></span> â­</span>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Game 1: Color Matching -->
        <section class="bg-white rounded-3xl shadow-xl p-6 mb-8 border-4 border-purple-300"
                 x-show="gameStage === 1">
            <h2 class="title-font text-3xl text-center text-purple-600 mb-6">ğŸ¯ Cocokkan Warna! ğŸ¯</h2>
            <p class="text-center text-xl text-gray-700 mb-6">Pilih warna yang sesuai dengan benda ini:</p>

            <div class="text-center mb-8">
                <div class="text-9xl mb-4" x-text="currentItem.emoji"></div>
                <p class="text-2xl font-bold text-gray-700" x-text="currentItem.name"></p>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                <template x-for="option in currentOptions" :key="option.color">
                    <button @click="checkAnswer(option.color)"
                            class="p-6 rounded-2xl text-white title-font text-2xl shadow-lg transition-all hover:scale-105"
                            :class="option.bgClass"
                            :class="{ 'shake': wrongAnswer }">
                        <span x-text="option.label"></span>
                    </button>
                </template>
            </div>

            <!-- Feedback -->
            <div x-show="showFeedback" x-transition
                 class="text-center p-6 rounded-2xl text-2xl"
                 :class="isCorrect ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'">
                <div class="text-5xl mb-2" x-text="isCorrect ? 'ğŸ‰' : 'ğŸ˜…'"></div>
                <p class="title-font" x-text="feedbackText"></p>
                <button x-show="isCorrect" @click="nextQuestion()"
                        class="mt-4 bg-gradient-to-r from-blue-400 to-blue-600 text-white px-6 py-3 rounded-full title-font text-xl hover:scale-105 transition-all">
                    â¡ï¸ Soal Berikutnya
                </button>
            </div>
        </section>

        <!-- Game 2: Find the Color -->
        <section class="bg-white rounded-3xl shadow-xl p-6 mb-8 border-4 border-green-300"
                 x-show="gameStage === 2"
                 x-transition>
            <h2 class="title-font text-3xl text-center text-green-600 mb-6">ğŸ” Temukan Warna! ğŸ”</h2>
            <p class="text-center text-xl text-gray-700 mb-6">Cari benda yang berwarna:</p>

            <div class="text-center mb-8">
                <div class="inline-block px-8 py-4 rounded-2xl title-font text-4xl text-white pulse-glow"
                     :class="targetColor.bgClass">
                    <span x-text="targetColor.label"></span>
                </div>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <template x-for="item in findColorItems" :key="item.id">
                    <button @click="checkFindColor(item)"
                            class="p-4 rounded-2xl bg-gradient-to-br from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 transition-all hover:scale-105 shadow-lg">
                        <div class="text-6xl mb-2" x-text="item.emoji"></div>
                        <p class="text-lg font-bold text-gray-700" x-text="item.name"></p>
                    </button>
                </template>
            </div>

            <!-- Feedback -->
            <div x-show="showFindFeedback" x-transition
                 class="text-center mt-6 p-6 rounded-2xl text-2xl"
                 :class="isFindCorrect ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'">
                <div class="text-5xl mb-2" x-text="isFindCorrect ? 'ğŸŒŸ' : 'ğŸ’­'"></div>
                <p class="title-font" x-text="findFeedbackText"></p>
            </div>

            <div x-show="foundAllCorrect" x-transition
                 class="text-center mt-6 p-6 rounded-2xl bg-gradient-to-r from-yellow-200 to-orange-200">
                <p class="title-font text-2xl text-orange-700 mb-4">ğŸ‰ Hebat! Adik-adik menemukan semuanya!</p>
                <button @click="startNextGame()"
                        class="bg-gradient-to-r from-purple-400 to-pink-400 text-white px-6 py-3 rounded-full title-font text-xl hover:scale-105 transition-all">
                    â¡ï¸ Game Berikutnya
                </button>
            </div>
        </section>

        <!-- Game 3: Color Pattern -->
        <section class="bg-white rounded-3xl shadow-xl p-6 mb-8 border-4 border-blue-300"
                 x-show="gameStage === 3"
                 x-transition>
            <h2 class="title-font text-3xl text-center text-blue-600 mb-6">ğŸ”· Lengkapi Pola! ğŸ”·</h2>
            <p class="text-center text-xl text-gray-700 mb-6">Warna apa yang seharusnya selanjutnya?</p>

            <div class="flex justify-center items-center gap-2 md:gap-4 mb-8 flex-wrap">
                <template x-for="color in pattern" :key="color.id">
                    <div class="w-16 h-16 md:w-20 md:h-20 rounded-2xl shadow-lg flex items-center justify-center text-white title-font text-xl"
                         :class="color.bgClass">
                        <span x-show="!color.isHidden" x-text="color.position"></span>
                        <span x-show="color.isHidden" class="text-3xl">â“</span>
                    </div>
                </template>
            </div>

            <p class="text-center text-lg text-gray-600 mb-6">Pilih warna untuk melengkapi pola:</p>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <template x-for="option in patternOptions" :key="option.color">
                    <button @click="checkPattern(option.color)"
                            class="p-6 rounded-2xl text-white title-font text-2xl shadow-lg transition-all hover:scale-105"
                            :class="option.bgClass">
                        <span x-text="option.label"></span>
                    </button>
                </template>
            </div>

            <!-- Feedback -->
            <div x-show="showPatternFeedback" x-transition
                 class="text-center mt-6 p-6 rounded-2xl text-2xl"
                 :class="isPatternCorrect ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'">
                <div class="text-5xl mb-2" x-text="isPatternCorrect ? 'âœ¨' : 'ğŸ¤”'"></div>
                <p class="title-font" x-text="patternFeedbackText"></p>
                <button x-show="isPatternCorrect" @click="nextPattern()"
                        class="mt-4 bg-gradient-to-r from-blue-400 to-blue-600 text-white px-6 py-3 rounded-full title-font text-xl hover:scale-105 transition-all">
                    â¡ï¸ Pola Berikutnya
                </button>
            </div>
        </section>

        <!-- Completion -->
        <section class="bg-white rounded-3xl shadow-xl p-8 border-4 border-yellow-400"
                 x-show="gameStage === 4"
                 x-transition>
            <div class="text-center">
                <div class="text-8xl mb-4">ğŸ†</div>
                <h2 class="title-font text-4xl text-yellow-600 mb-4">SELAMAT!</h2>
                <p class="text-2xl text-gray-700 mb-6">Adik-adik sudah menyelesaikan semua latihan!</p>
                <div class="bg-gradient-to-r from-yellow-200 to-orange-200 rounded-2xl p-6 mb-6">
                    <p class="title-font text-3xl text-orange-700">Skor Akhir: <span x-text="score"></span> â­</p>
                </div>
                <div class="space-y-4">
                    <a href="evaluasi.html" class="inline-block bg-gradient-to-r from-green-400 to-green-600 text-white title-font text-2xl px-8 py-4 rounded-full shadow-lg hover:scale-105 transition-all">
                        â¡ï¸ Lanjut ke Evaluasi
                    </a>
                    <br>
                    <button @click="restartGame()" class="inline-block bg-gradient-to-r from-purple-400 to-pink-400 text-white title-font text-xl px-6 py-3 rounded-full shadow-lg hover:scale-105 transition-all">
                        ğŸ”„ Main Lagi
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 mt-8">
        <div class="container mx-auto px-4 text-center">
            <p class="text-lg">Â© 2024 Bahan Ajar Interaktif - TK-B Seni</p>
            <p class="text-sm mt-1">Belajar dengan Ceria dan Bahagia! ğŸŒŸ</p>
        </div>
    </footer>

    <script>
        function colorGame() {
            return {
                score: 0,
                gameStage: 1,
                showFeedback: false,
                isCorrect: false,
                feedbackText: '',
                wrongAnswer: false,
                currentItem: {},
                currentOptions: [],
                currentQuestionIndex: 0,
                questions: [
                    { emoji: 'ğŸ', name: 'Apel', correct: 'merah' },
                    { emoji: 'ğŸŒ', name: 'Pisang', correct: 'kuning' },
                    { emoji: 'ğŸŒŠ', name: 'Laut', correct: 'biru' },
                    { emoji: 'ğŸŒ³', name: 'Rumput', correct: 'hijau' },
                    { emoji: 'ğŸ¥•', name: 'Wortel', correct: 'orange' },
                    { emoji: 'ğŸ‡', name: 'Anggur', correct: 'ungu' },
                ],
                colors: {
                    merah: { label: 'MERAH', bgClass: 'bg-gradient-to-br from-red-400 to-red-600' },
                    kuning: { label: 'KUNING', bgClass: 'bg-gradient-to-br from-yellow-300 to-yellow-500' },
                    biru: { label: 'BIRU', bgClass: 'bg-gradient-to-br from-blue-400 to-blue-600' },
                    hijau: { label: 'HIJAU', bgClass: 'bg-gradient-to-br from-green-400 to-green-600' },
                    orange: { label: 'ORANGE', bgClass: 'bg-gradient-to-br from-orange-400 to-orange-600' },
                    ungu: { label: 'UNGU', bgClass: 'bg-gradient-to-br from-purple-400 to-purple-600' }
                },
                findColorItems: [],
                targetColor: {},
                foundItems: [],
                showFindFeedback: false,
                isFindCorrect: false,
                findFeedbackText: '',
                foundAllCorrect: false,
                pattern: [],
                patternOptions: [],
                showPatternFeedback: false,
                isPatternCorrect: false,
                patternFeedbackText: '',
                patternIndex: 0,

                init() {
                    this.currentQuestionIndex = 0;
                    this.loadQuestion();
                },

                loadQuestion() {
                    if (this.currentQuestionIndex >= this.questions.length) {
                        this.startFindColorGame();
                        return;
                    }

                    this.currentItem = this.questions[this.currentQuestionIndex];
                    this.currentOptions = this.getShuffledOptions(this.currentItem.correct);
                    this.showFeedback = false;
                    this.isCorrect = false;
                    this.feedbackText = '';
                    this.wrongAnswer = false;
                },

                getShuffledOptions(correctColor) {
                    const allColors = Object.keys(this.colors);
                    const options = [correctColor];
                    const remaining = allColors.filter(c => c !== correctColor);

                    while (options.length < 3 && remaining.length > 0) {
                        const randomIndex = Math.floor(Math.random() * remaining.length);
                        options.push(remaining.splice(randomIndex, 1)[0]);
                    }

                    return this.shuffle(options).map(color => ({
                        color,
                        label: this.colors[color].label,
                        bgClass: this.colors[color].bgClass
                    }));
                },

                shuffle(array) {
                    const newArray = [...array];
                    for (let i = newArray.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
                    }
                    return newArray;
                },

                checkAnswer(selectedColor) {
                    if (this.showFeedback && this.isCorrect) return;

                    this.showFeedback = true;
                    this.isCorrect = selectedColor === this.currentItem.correct;

                    if (this.isCorrect) {
                        this.score += 10;
                        this.feedbackText = `ğŸ‰ Benar! ${this.currentItem.name} berwarna ${this.colors[selectedColor].label}!`;
                        this.createConfetti();
                    } else {
                        this.feedbackText = `ğŸ˜… Almost! Coba lagi ya!`;
                        this.wrongAnswer = true;
                        setTimeout(() => {
                            this.wrongAnswer = false;
                            this.showFeedback = false;
                        }, 1500);
                    }
                },

                nextQuestion() {
                    this.currentQuestionIndex++;
                    this.loadQuestion();
                },

                startFindColorGame() {
                    this.gameStage = 2;
                    const allColors = Object.keys(this.colors);
                    this.targetColor = allColors[Math.floor(Math.random() * allColors.length)];
                    this.targetColor = { ...this.colors[this.targetColor], color: this.targetColor };

                    this.findColorItems = [
                        { id: 1, emoji: 'ğŸ', name: 'Apel', color: 'merah' },
                        { id: 2, emoji: 'ğŸŒ', name: 'Pisang', color: 'kuning' },
                        { id: 3, emoji: 'ğŸŒŠ', name: 'Laut', color: 'biru' },
                        { id: 4, emoji: 'ğŸŒ³', name: 'Rumput', color: 'hijau' },
                        { id: 5, emoji: 'ğŸ¥•', name: 'Wortel', color: 'orange' },
                        { id: 6, emoji: 'ğŸ‡', name: 'Anggur', color: 'ungu' },
                        { id: 7, emoji: 'ğŸ', name: 'Apel', color: 'merah' },
                        { id: 8, emoji: 'ğŸŒ', name: 'Pisang', color: 'kuning' },
                    ];
                    this.foundItems = [];
                    this.showFindFeedback = false;
                    this.foundAllCorrect = false;
                },

                checkFindColor(item) {
                    this.showFindFeedback = true;
                    this.isFindCorrect = item.color === this.targetColor.color;

                    if (this.isFindCorrect && !this.foundItems.includes(item.id)) {
                        this.foundItems.push(item.id);
                        this.findFeedbackText = `âœ… Benar! ${item.name} berwarna ${this.targetColor.label}!`;
                        this.score += 5;

                        if (this.foundItems.length >= 2) {
                            this.foundAllCorrect = true;
                            this.showFindFeedback = false;
                        }
                    } else if (!this.isFindCorrect) {
                        this.findFeedbackText = `ğŸ’­ Oops! ${item.name} bukan warna ${this.targetColor.label}. Coba yang lain!`;
                        setTimeout(() => {
                            this.showFindFeedback = false;
                        }, 2000);
                    } else {
                        this.findFeedbackText = `ğŸ‘ Sudah ketemu yang ini! Cari yang lain!`;
                        setTimeout(() => {
                            this.showFindFeedback = false;
                        }, 1500);
                    }
                },

                startNextGame() {
                    this.gameStage = 3;
                    this.patternIndex = 0;
                    this.loadPattern();
                },

                loadPattern() {
                    if (this.patternIndex >= 3) {
                        this.gameStage = 4;
                        return;
                    }

                    const patterns = [
                        ['merah', 'kuning', 'merah', 'kuning', '?'],
                        ['biru', 'hijau', 'biru', 'hijau', '?'],
                        ['orange', 'ungu', 'orange', 'ungu', '?'],
                    ];

                    const currentPattern = patterns[this.patternIndex];
                    this.pattern = currentPattern.map((color, index) => ({
                        id: index,
                        color: color === '?' ? null : color,
                        isHidden: color === '?',
                        position: index + 1,
                        bgClass: color === '?' ? 'bg-gray-300' : this.colors[color].bgClass
                    }));

                    const correctColor = currentPattern[3];
                    this.patternOptions = this.getShuffledOptions(correctColor);
                    this.showPatternFeedback = false;
                    this.isPatternCorrect = false;
                    this.patternFeedbackText = '';
                },

                checkPattern(selectedColor) {
                    if (this.showPatternFeedback && this.isPatternCorrect) return;

                    this.showPatternFeedback = true;
                    const correctColor = this.pattern[3].color;
                    this.isPatternCorrect = selectedColor === correctColor;

                    if (this.isPatternCorrect) {
                        this.score += 15;
                        this.patternFeedbackText = `âœ¨ Hebat! Pola lengkap!`;
                        this.pattern[4].color = selectedColor;
                        this.pattern[4].bgClass = this.colors[selectedColor].bgClass;
                        this.pattern[4].isHidden = false;
                        this.createConfetti();
                    } else {
                        this.patternFeedbackText = `ğŸ¤” Hmm, bukan itu. Coba perhatikan polanya lagi!`;
                        setTimeout(() => {
                            this.showPatternFeedback = false;
                        }, 2000);
                    }
                },

                nextPattern() {
                    this.patternIndex++;
                    this.loadPattern();
                },

                restartGame() {
                    this.score = 0;
                    this.gameStage = 1;
                    this.currentQuestionIndex = 0;
                    this.loadQuestion();
                },

                createConfetti() {
                    const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
                    for (let i = 0; i < 30; i++) {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + 'vw';
                        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                        confetti.style.animationDelay = Math.random() * 2 + 's';
                        document.body.appendChild(confetti);

                        setTimeout(() => confetti.remove(), 3000);
                    }
                }
            }
        }
    </script>
</body>
</html>
